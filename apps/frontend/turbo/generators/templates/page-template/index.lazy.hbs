import PageTemplate from "@/components/PageTemplate";
import { Button } from "@repo/ui";
import client from "@/honoClient";
import createActionButtons from "@/utils/createActionButton";
import { createLazyFileRoute } from "@tanstack/react-router";
import { TbEye, TbPencil, TbTrash } from "react-icons/tb";

export const Route = createLazyFileRoute("/_dashboardLayout/{{pathCase path}}")({
	component: RouteComponent,
});

export default function RouteComponent() {

	return (
		<PageTemplate
			title="{{title}}"
			endpoint={client.{{dotCase endpoint}}.$get}
			queryKey={["{{endpoint}}"]}
			// Define which columns can be sorted
			sortableColumns={["column1", "column2"]}
			// Enable server-side sorting (optional, default: false)
			// serverSideSorting={true}
			// Define which columns can be filtered
			filterableColumns={[
				{
					id: "column1",
					type: "text",
					// Enable server-side filtering for this column (optional, default: false)
					// serverSide: true
				},
				{
					id: "status",
					type: "select",
					options: [
						{ label: "Active", value: "active" },
						{ label: "Inactive", value: "inactive" }
					],
					// Enable server-side filtering for this column (optional, default: false)
					// serverSide: true
				},
				{
					id: "createdAt",
					type: "daterange",
					dateFormat: "MMM dd, yyyy"
				}
			]}
			// Enable column borders (optional)
			columnBorders={true}
			// Define which columns cannot be resized (optional)
			nonResizableColumns={["column1"]}
			columnDefs={(helper) => [
				helper.display({
					header: "#",
					cell: (props) => props.row.index + 1,
					size: 1,
				}),
				//TODO: Change the column1 and column2 to the actual column names
				helper.accessor("column1", {
					cell: (info) => info.getValue(),
					header: "Column1" // The sortable button will be added automatically
				}),
				helper.accessor("column2", {
					cell: (info) => info.getValue(),
					header: "Column2" // The sortable button will be added automatically
				}),
				helper.accessor("status", {
					cell: (info) => info.getValue(),
					header: "Status"
				}),
				helper.accessor("createdAt", {
					cell: (info) => {
						const date = info.getValue();
						return date ? new Date(date).toLocaleDateString() : '-';
					},
					header: "Created At"
				}),
				helper.display({
					header: "Actions",
					cell: (props) => (
						<div className="flex gap-2">
							{createActionButtons([
								{
									label: "Detail",
									permission: true,
									action: `./detail/${props.row.original.id}`,
									className: "bg-green-500 hover:bg-green-600",
									icon: <TbEye />,
								},
								{
									label: "Edit",
									permission: true,
									action: `./edit/${props.row.original.id}`,
									className: "bg-yellow-500 hover:bg-yellow-600",
									icon: <TbPencil />,
								},
								{
									label: "Delete",
									permission: true,
									action: `./delete/${props.row.original.id}`,
									variant: "outline",
									className:
										"border-red-500 text-red-500 hover:bg-red-500 hover:text-white",
									icon: <TbTrash />,
								},
							])}
						</div>
					),
				}),
			]}
		/>
	);
}
